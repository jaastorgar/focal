{% load static %}
{% load widget_tweaks %}

<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <title>Registro | FOCAL</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="icon" href="{% static 'inventario/img/favicon.ico' %}" type="image/x-icon">
    <link rel="stylesheet" href="{% static 'landing/css/registro.css' %}">
    <link rel="stylesheet" href="{% static 'landing/css/styles.css' %}">
</head>
<body>
    <!-- =========================
        HEADER / NAVBAR
    ========================== -->
    <header class="main-header" id="home">
        <div class="container">
        <a class="logo" href="#home" aria-label="Inicio">
            <!-- Reemplazo del texto por logo, tal como indicaste -->
            <img src="/static/landing/img/Focal_imagotipo.svg" alt="Bootstrap" width="30" height="24" style="vertical-align:middle;margin-right:.5rem">
            <span class="logo-text sr-only">SOY FOCAL</span>
        </a>

        <button class="menu-toggle" aria-label="Abrir men√∫">‚ò∞</button>

        <nav class="main-nav" aria-label="Navegaci√≥n principal">
            <ul>
            <li><a href="{% url 'landing:landing' %}">Inicio</a></li>
            <li><a href="{% url 'landing:landing' %}#features">Qu√© ofrecemos</a></li>
            <li><a href="{% url 'landing:quienes_somos' %}">Nosotros</a></li>
            <li><a href="{% url 'landing:landing' %}#contact">Contacto</a></li>
            <li><a class="btn btn-primary" href="{% url 'landing:login' %}">Iniciar sesi√≥n</a></li>
            <li><a class="btn btn-secondary" href="{% url 'landing:registro' %}">Reg√≠strate</a></li>
            </ul>
        </nav>
        </div>
    </header>

    <main class="registration-container">
        <h2 class="form-title">Crea tu Cuenta en FOCAL</h2>
        <p class="form-subtitle">Reg√≠strate para empezar a gestionar tu negocio de forma inteligente.</p>

        {% for message in messages %}
            <div class="alert alert-{{ message.tags }}">{{ message }}</div>
        {% endfor %}

        <form method="post" class="registration-form" novalidate>
            {% csrf_token %}

            <!-- === 1. DATOS DEL ADMINISTRADOR === -->
            <div class="form-section">
                <h3 class="section-heading">1. Datos del Administrador</h3>
                <div class="form-grid">
                    {% for field in user_form %}
                        <div class="form-group">
                            <label for="{{ field.id_for_label }}" class="form-label">{{ field.label }}</label>

                            <!-- Campo con atributos data para regi√≥n y comuna -->
                            {% if field.name == 'region' %}
                                {{ field|add_class:"form-select"|attr:"data-region-target:almacenero"|attr:"id:id_almacenero-region" }}
                            {% elif field.name == 'comuna' %}
                                {{ field|add_class:"form-select"|attr:"data-comuna-target:almacenero"|attr:"id:id_almacenero-comuna" }}
                            {% else %}
                                {{ field }}
                            {% endif %}

                            <!-- Feedback de contrase√±a -->
                            {% if field.name == 'password1' %}
                                <div id="password-feedback" class="password-requirements">
                                    <ul>
                                        <li id="req-length">Entre 8 y 12 caracteres</li>
                                        <li id="req-uppercase">Al menos una may√∫scula (A-Z)</li>
                                        <li id="req-lowercase">Al menos una min√∫scula (a-z)</li>
                                        <li id="req-number">Al menos un n√∫mero (0-9)</li>
                                        <li id="req-special">Al menos un car√°cter especial (_!@#$...)</li>
                                        <li id="req-match">Las contrase√±as deben coincidir</li>
                                    </ul>
                                </div>
                            {% endif %}

                            <!-- Errores -->
                            {% if field.errors %}
                                <div class="error-message">{{ field.errors|striptags }}</div>
                            {% endif %}
                        </div>
                    {% endfor %}
                </div>
            </div>

            <!-- === 2. DATOS DE LA EMPRESA === -->
            <div class="form-section">
                <h3 class="section-heading">2. Datos de la Empresa</h3>
                <div class="form-grid">
                    {% for field in empresa_form %}
                        <div class="form-group">
                            <label for="{{ field.id_for_label }}" class="form-label">{{ field.label }}</label>

                            {% if field.name == 'region' %}
                                {{ field|add_class:"form-select"|attr:"data-region-target:empresa"|attr:"id:id_empresa-region" }}
                            {% elif field.name == 'comuna' %}
                                {{ field|add_class:"form-select"|attr:"data-comuna-target:empresa"|attr:"id:id_empresa-comuna" }}
                            {% else %}
                                {{ field }}
                            {% endif %}

                            {% if field.errors %}
                                <div class="error-message">{{ field.errors|striptags }}</div>
                            {% endif %}
                        </div>
                    {% endfor %}
                </div>
            </div>

            <div class="form-submit-container">
                <button type="submit" class="btn-submit">Crear Cuenta</button>
            </div>
        </form>
    </main>

    <!-- =========================
        FOOTER
    ========================== -->
    <footer class="main-footer">
        <div class="container">
        <div class="footer-grid">
            <div class="footer-col">
            <a class="footer-logo" href="#home">
                <img src="/static/landing/img/Focal_imagotipo.svg" alt="Bootstrap" width="30" height="24" style="vertical-align:middle;margin-right:.5rem">
                <span class="sr-only">SOY FOCAL</span>
            </a>
            <p class="footer-text">
                Herramientas simples para un control inteligente de tu inventario.
            </p>

            <ul class="contact-list">
                <li>
                <a class="contact-chip" href="mailto:soporte@soyfocal.cl">
                    <span class="chip-ico">üìß</span> soporte@soyfocal.cl
                </a>
                </li>
                <li>
                <a class="contact-chip" href="mailto:ventas@soyfocal.cl">
                    <span class="chip-ico">üõí</span> ventas@soyfocal.cl
                </a>
                </li>
            </ul>
            </div>

            <div class="footer-col">
            <h4 class="footer-title">Producto</h4>
            <nav class="footer-links">
                <a href="#features">Caracter√≠sticas</a>
                <a href="/metrics/">M√©tricas</a>
                <a href="/inventario/">Inventario</a>
            </nav>
            </div>

            <div class="footer-col">
            <h4 class="footer-title">Compa√±√≠a</h4>
            <nav class="footer-links">
                <a href="#cta">Nosotros</a>
                <a href="#contact">Contacto</a>
                <a href="/registro/">Registro</a>
            </nav>
            </div>
        </div>

        <hr class="footer-divider" />

        <div class="footer-bottom">
            <p class="footer-copy">¬© <span id="year"></span> FOCAL. Todos los derechos reservados.</p>
        </div>    
        </div>
    </footer>

    <!-- Flotantes (Instagram / WhatsApp) -->
    <div class="floating-social" aria-hidden="true">
        <a class="float-btn ig" href="https://instagram.com/" target="_blank" rel="noopener" aria-label="Instagram">
        <i class="bi bi-instagram"></i>
        </a>
        <a class="float-btn wa" href="https://wa.me/" target="_blank" rel="noopener" aria-label="WhatsApp">
        <i class="bi bi-whatsapp"></i>
        </a>
    </div>

    <script>
        // A√±o din√°mico en el footer
        document.getElementById('year').textContent = new Date().getFullYear();
    </script>
    <!-- Registro JS -->
    <script src="{% static 'landing/js/registro.js' %}" defer></script>
</body>
</html>