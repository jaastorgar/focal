{% load static %}
<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>FOCAL - Dashboard Financiero</title>
    <link rel="icon" href="{% static 'inventario/img/favicon.ico' %}" type="image/x-icon">
    <link rel="stylesheet" href="{% static 'finanza/css/finanza.css' %}">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
<body>
    <!-- Header -->
    <header class="header">
        <div class="container">
            <div class="header-content">
                <h1 class="logo">FOCAL</h1>
                <div class="header-actions">
                    <button id="btnAddTransaction" class="btn-primary">
                        <span class="icon">+</span>
                        A√±adir Transacci√≥n
                    </button>
                    <div class="user-info">
                        <span class="bell-icon">üîî</span>
                        <div class="user-details">
                            <p class="user-name">Gabriel Ignacio</p>
                            <p class="user-label">Mi Cuenta</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </header>

    <!-- Navigation -->
    <nav class="navigation">
        <div class="container">
            <div class="nav-items">
                <a href="{% url 'home' %}" class="nav-item nav-link">
                    <span>‚Üê Volver al Inicio</span>
                </a>
                <button class="nav-item active" data-section="dashboard">Dashboard</button>
                <button class="nav-item" data-section="ingresos">Ingresos</button>
                <button class="nav-item" data-section="gastos">Gastos</button>
                <button class="nav-item" data-section="proyecciones">Proyecciones</button>
                <button class="nav-item" data-section="reportes">Reportes</button>
            </div>
        </div>
    </nav>

    <!-- Modal A√±adir Transacci√≥n -->
    <div id="modalTransaction" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Nueva Transacci√≥n</h3>
                <button class="modal-close" id="closeModal">&times;</button>
            </div>
            <form id="formTransaction" class="modal-form">
                <div class="form-group">
                    <label>Tipo</label>
                    <select id="transactionType" required>
                        <option value="income">Ingreso</option>
                        <option value="expense">Gasto</option>
                    </select>
                </div>
                <div class="form-group">
                    <label>Fecha</label>
                    <input type="date" id="transactionDate" required>
                </div>
                <div class="form-group">
                    <label>Descripci√≥n</label>
                    <input type="text" id="transactionDescription" placeholder="Ej: Venta de servicio..." required>
                </div>
                <div class="form-group">
                    <label>Categor√≠a</label>
                    <select id="transactionCategory" required>
                        <option value="Ventas">Ventas</option>
                        <option value="Consultor√≠a">Consultor√≠a</option>
                        <option value="Servicios">Servicios</option>
                        <option value="Sueldos">Sueldos</option>
                        <option value="Marketing">Marketing</option>
                        <option value="Oficina">Oficina</option>
                        <option value="Otros">Otros</option>
                    </select>
                </div>
                <div class="form-group">
                    <label>Monto (CLP)</label>
                    <input type="number" id="transactionAmount" placeholder="0" required>
                </div>
                <div class="modal-actions">
                    <button type="button" class="btn-secondary" id="cancelModal">Cancelar</button>
                    <button type="submit" class="btn-primary">Guardar</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Main Content -->
    <main class="main-content">
        <div class="container">
            <!-- DASHBOARD SECTION -->
            <div id="section-dashboard" class="section active">
                <!-- KPIs -->
                <div class="kpi-grid">
                    <div class="kpi-card">
                        <div class="kpi-content">
                            <p class="kpi-label">Saldo Actual</p>
                            <p class="kpi-value" id="saldoActual">$8,500,000</p>
                        </div>
                        <div class="kpi-icon bg-purple">üí∞</div>
                    </div>
                    <div class="kpi-card">
                        <div class="kpi-content">
                            <p class="kpi-label">Ingresos del Mes</p>
                            <p class="kpi-value text-green" id="ingresosDelMes">$6,200,000</p>
                        </div>
                        <div class="kpi-icon bg-green">üìà</div>
                    </div>
                    <div class="kpi-card">
                        <div class="kpi-content">
                            <p class="kpi-label">Gastos del Mes</p>
                            <p class="kpi-value text-red" id="gastosDelMes">$4,300,000</p>
                        </div>
                        <div class="kpi-icon bg-red">üìâ</div>
                    </div>
                    <div class="kpi-card">
                        <div class="kpi-content">
                            <p class="kpi-label">Resultado</p>
                            <p class="kpi-value text-green" id="resultado">$1,900,000</p>
                        </div>
                        <div class="kpi-icon bg-green">‚úì</div>
                    </div>
                </div>

                <!-- Gr√°ficos -->
                <div class="chart-grid">
                    <div class="chart-card">
                        <h3>Flujo de Caja 2025</h3>
                        <canvas id="cashFlowChart"></canvas>
                    </div>
                    <div class="chart-card">
                        <h3>Ingresos por Categor√≠a</h3>
                        <canvas id="incomePieChart"></canvas>
                    </div>
                </div>

                <!-- Alertas y Meta -->
                <div class="info-grid">
                    <div class="info-card">
                        <div class="info-header">
                            <span>üîî</span>
                            <h3>Alertas y Notificaciones</h3>
                        </div>
                        <div class="alerts-container" id="alertsContainer"></div>
                    </div>
                    <div class="info-card">
                        <div class="info-header">
                            <span>üéØ</span>
                            <h3>Meta Mensual</h3>
                        </div>
                        <div class="goal-container">
                            <div class="goal-row">
                                <span>Objetivo:</span>
                                <span class="goal-value">$7,000,000</span>
                            </div>
                            <div class="goal-row">
                                <span>Actual:</span>
                                <span class="goal-value text-purple">$6,200,000</span>
                            </div>
                            <div class="goal-progress">
                                <div class="progress-label">
                                    <span>Progreso</span>
                                    <span id="goalProgress">88.6%</span>
                                </div>
                                <div class="progress-bar">
                                    <div class="progress-fill" id="progressFill" style="width: 88.6%"></div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- INGRESOS SECTION -->
            <div id="section-ingresos" class="section">
                <div class="table-card">
                    <div class="table-header">
                        <h3>Historial de Ingresos</h3>
                        <div class="table-actions">
                            <input type="text" id="searchIngresos" placeholder="üîç Buscar..." class="search-input">
                            <button class="btn-filter">üîΩ Filtrar</button>
                        </div>
                    </div>
                    <div class="table-responsive">
                        <table class="data-table">
                            <thead>
                                <tr>
                                    <th>Fecha</th>
                                    <th>Descripci√≥n</th>
                                    <th>Categor√≠a</th>
                                    <th class="text-right">Monto</th>
                                    <th class="text-center">Acciones</th>
                                </tr>
                            </thead>
                            <tbody id="ingresosTable"></tbody>
                        </table>
                    </div>
                </div>
            </div>

            <!-- GASTOS SECTION -->
            <div id="section-gastos" class="section">
                <div class="table-card">
                    <div class="table-header">
                        <h3>Historial de Gastos</h3>
                        <div class="table-actions">
                            <input type="text" id="searchGastos" placeholder="üîç Buscar..." class="search-input">
                            <button class="btn-filter">üîΩ Filtrar</button>
                        </div>
                    </div>
                    <div class="table-responsive">
                        <table class="data-table">
                            <thead>
                                <tr>
                                    <th>Fecha</th>
                                    <th>Descripci√≥n</th>
                                    <th>Categor√≠a</th>
                                    <th class="text-center">Estado</th>
                                    <th class="text-right">Monto</th>
                                    <th class="text-center">Acciones</th>
                                </tr>
                            </thead>
                            <tbody id="gastosTable"></tbody>
                        </table>
                    </div>
                </div>
                <div class="chart-card">
                    <h3>Gastos por Categor√≠a</h3>
                    <canvas id="expensesChart"></canvas>
                </div>
            </div>

            <!-- PROYECCIONES SECTION -->
            <div id="section-proyecciones" class="section">
                <div class="chart-card">
                    <h3>Proyecci√≥n Anual 2025</h3>
                    <canvas id="projectionChart"></canvas>
                </div>
                <div class="projection-grid">
                    <div class="projection-card">
                        <h3>Configurar Meta Anual</h3>
                        <form class="projection-form">
                            <div class="form-group">
                                <label>Objetivo de Ingresos Anuales</label>
                                <input type="text" value="$75,000,000">
                            </div>
                            <div class="form-group">
                                <label>Plazo</label>
                                <select>
                                    <option>Diciembre 2025</option>
                                    <option>Junio 2026</option>
                                    <option>Diciembre 2026</option>
                                </select>
                            </div>
                            <button type="submit" class="btn-primary full-width">Guardar Meta</button>
                        </form>
                    </div>
                    <div class="projection-card">
                        <h3>Resumen de Proyecci√≥n</h3>
                        <div class="summary-container">
                            <div class="summary-row">
                                <span>Ingresos Real (Ene-Sep)</span>
                                <span class="summary-value">$36,200,000</span>
                            </div>
                            <div class="summary-row">
                                <span>Proyecci√≥n (Oct-Dic)</span>
                                <span class="summary-value text-purple">$21,700,000</span>
                            </div>
                            <div class="summary-row highlight">
                                <span>Total Esperado 2025</span>
                                <span class="summary-value">$57,900,000</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- REPORTES SECTION -->
            <div id="section-reportes" class="section">
                <div class="report-card">
                    <h3>Generador de Reportes</h3>
                    <form class="report-form">
                        <div class="form-grid">
                            <div class="form-group">
                                <label>Tipo de Reporte</label>
                                <select>
                                    <option>Estado de Resultados (P&G)</option>
                                    <option>Flujo de Caja</option>
                                    <option>Resumen de Gastos por Categor√≠a</option>
                                    <option>Ingresos por Categor√≠a</option>
                                    <option>Reporte Completo</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label>Rango de Fechas</label>
                                <select>
                                    <option>Este mes</option>
                                    <option>√öltimos 3 meses</option>
                                    <option>√öltimos 6 meses</option>
                                    <option>Este a√±o</option>
                                    <option>Personalizado</option>
                                </select>
                            </div>
                        </div>
                        <div class="report-actions">
                            <button type="button" class="btn-primary">üìÑ Exportar a PDF</button>
                            <button type="button" class="btn-success">üìä Descargar CSV</button>
                        </div>
                    </form>
                </div>

                <div class="preview-card">
                    <h3>Vista Previa: Estado de Resultados</h3>
                    <div class="report-preview">
                        <div class="report-header">
                            <h4>FOCAL</h4>
                            <p>Estado de Resultados</p>
                            <p>Septiembre 2025</p>
                        </div>
                        <div class="report-section">
                            <div class="report-line header-line text-green">
                                <span>INGRESOS</span>
                                <span>$6,200,000</span>
                            </div>
                            <div class="report-line indent">
                                <span>Ventas</span>
                                <span>$3,500,000</span>
                            </div>
                            <div class="report-line indent">
                                <span>Consultor√≠a</span>
                                <span>$2,000,000</span>
                            </div>
                            <div class="report-line indent">
                                <span>Otros</span>
                                <span>$700,000</span>
                            </div>
                        </div>
                        <div class="report-section">
                            <div class="report-line header-line text-red">
                                <span>GASTOS</span>
                                <span>$4,300,000</span>
                            </div>
                            <div class="report-line indent">
                                <span>Sueldos</span>
                                <span>$3,200,000</span>
                            </div>
                            <div class="report-line indent">
                                <span>Marketing</span>
                                <span>$450,000</span>
                            </div>
                            <div class="report-line indent">
                                <span>Otros</span>
                                <span>$650,000</span>
                            </div>
                        </div>
                        <div class="report-section">
                            <div class="report-line total-line text-green">
                                <span>RESULTADO NETO</span>
                                <span>$1,900,000</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </main>
    <!-- Bot√≥n Asistente (antes del footer) -->
<div class="assistant-container">
    <div class="floating-assistant" onclick="openAssistant()">
        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" viewBox="0 0 16 16">
            <path d="M6 12.5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 0 1h-3a.5.5 0 0 1-.5-.5M3 8.062C3 6.76 4.235 5.765 5.53 5.886a26.6 26.6 0 0 0 4.94 0C11.765 5.765 13 6.76 13 8.062v1.157a.93.93 0 0 1-.765.935c-.845.147-2.34.346-4.235.346s-3.39-.2-4.235-.346A.93.93 0 0 1 3 9.219zm4.542-.827a.25.25 0 0 0-.217.068l-.92.9a25 25 0 0 1-1.871-.183.25.25 0 0 0-.068.495c.55.076 1.232.149 2.02.193a.25.25 0 0 0 .189-.071l.754-.736.847 1.71a.25.25 0 0 0 .404.062l.932-.97a25 25 0 0 0 1.922-.188.25.25 0 0 0-.068-.495c-.538.074-1.207.145-1.98.189a.25.25 0 0 0-.166.076l-.754.785-.842-1.7a.25.25 0 0 0-.182-.135"/>
            <path d="M8.5 1.866a1 1 0 1 0-1 0V3h-2A4.5 4.5 0 0 0 1 7.5V8a1 1 0 0 0-1 1v2a1 1 0 0 0 1 1v1a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2v-1a1 1 0 0 0 1-1V9a1 1 0 0 0-1-1v-.5A4.5 4.5 0 0 0 10.5 3h-2zM14 7.5V13a1 1 0 0 1-1 1H3a1 1 0 0 1-1-1V7.5A3.5 3.5 0 0 1 5.5 4h5A3.5 3.5 0 0 1 14 7.5"/>
        </svg>
    </div>
</div>
    <!-- Footer -->
    <footer class="footer">
        <p>¬© 2025 FOCAL. Todos los derechos reservados.</p>
    </footer>
 

    </div>
    <script src="{% static 'finanza/js/finanza.js' %}"></script>
</body>
</html>